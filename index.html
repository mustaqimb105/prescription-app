<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Prescription</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #f2f2f2;
}
.container {
    display: flex;
    flex-wrap: wrap;
    padding: 10px;
    gap: 10px;
}
.form-container, .preview-container {
    background: #fff;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border-radius: 8px;
    flex: 1 1 300px;
}
.form-container { min-width: 280px; }
.preview-container { min-width: 280px; overflow-x: auto; }

h2 { margin-top: 0; color: #004080; }
label { display: block; margin-top: 10px; font-weight: bold; }
input, textarea, select { width: 100%; padding: 8px; margin-top: 3px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
textarea { resize: vertical; }
button { margin-top: 10px; padding: 8px 12px; border: none; background-color: #004080; color: white; border-radius: 5px; cursor: pointer; }
button:hover { background-color: #003366; }

.drug-table { width: 100%; border-collapse: collapse; margin-top: 5px; }
.drug-table th, .drug-table td { padding: 5px; text-align: left; }

.prescription {
    width: 100%;
    min-height: 29.7cm; /* A4 */
    padding: 40px 60px;
    background: #fff;
    box-sizing: border-box;
    color: #000;
    line-height: 1.5;
}
.header { text-align: center; margin-bottom: 20px; }
.header h3, .header h4 { margin: 2px 0; }
.patient-info { margin-bottom: 20px; }
.content { display: flex; gap: 20px; }
.left { width: 33%; }
.right { width: 67%; }
.signature { text-align: right; margin-top: 80px; font-weight: bold; }

@media (max-width: 768px) { .container { flex-direction: column; } .content { flex-direction: column; } .left, .right { width: 100%; } }

@media print {
    body * { visibility: hidden; }
    .prescription, .prescription * { visibility: visible; }
    .prescription { width: 100%; height: 29.7cm; padding: 40px 60px; box-shadow: none; }
    .form-container { display: none; }
    .drug-table, .drug-table th, .drug-table td { border: none; padding: 0; }
}
</style>
</head>
<body>

<div class="container">
    <!-- Form -->
    <div class="form-container">
        <h2>Prescription Maker</h2>
        <label>Doctor Name & Credentials</label>
        <input type="text" id="doctorName" placeholder="Dr. A B C, MBBS, FCPS">
        <label>Clinic / Hospital</label>
        <input type="text" id="clinicName" placeholder="City Clinic">

        <label>Patient Name</label>
        <input type="text" id="patientName" placeholder="Patient Name">
        <label>Date of Birth</label>
        <input type="date" id="dob" onchange="updatePreview()">
        <label>Gender</label>
        <select id="patientGender" onchange="updatePreview()">
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
        </select>
        <label>Date of Prescription</label>
        <input type="date" id="prescriptionDate">

        <label>Chief Complaints</label>
        <textarea id="complaints" rows="2"></textarea>
        <label>On Examination</label>
        <textarea id="examination" rows="2"></textarea>
        <label>Investigations</label>
        <textarea id="investigations" rows="2"></textarea>
        <label>Diagnosis</label>
        <textarea id="diagnosis" rows="2"></textarea>

        <label>Drugs</label>
        <table class="drug-table" id="drugTable">
            <thead>
                <tr>
                    <th>Drug Name</th>
                    <th>Dose</th>
                    <th>Times/Day</th>
                    <th>Duration</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button type="button" onclick="addDrugRow()">+ Add Drug</button>
        <button type="button" onclick="clearForm()">Clear Form</button>
        <button type="button" onclick="printPrescription()">Print Prescription</button>
    </div>

    <!-- Preview -->
    <div class="preview-container">
        <div class="prescription" id="prescriptionPreview">
            <div class="header">
                <h3 id="docNamePreview">Dr. Name, Credentials</h3>
                <h4 id="clinicPreview">Clinic / Hospital</h4>
            </div>
            <div class="patient-info">
                <strong>Date:</strong> <span id="datePreview">--</span><br>
                <strong>Patient:</strong> <span id="patientPreview">Name</span><br>
                <strong>DOB / Age / Gender:</strong> <span id="dobAgeGenderPreview">--</span>
            </div>
            <div class="content">
                <div class="left">
                    <div><strong>Chief Complaints:</strong> <span id="complaintsPreview">--</span></div>
                    <div><strong>On Examination:</strong> <span id="examinationPreview">--</span></div>
                    <div><strong>Investigations:</strong> <span id="investigationsPreview">--</span></div>
                </div>
                <div class="right">
                    <div><strong>Prescription / Medicines:</strong>
                        <ul id="drugsPreview"></ul>
                    </div>
                </div>
            </div>
            <div class="signature">Doctor Signature</div>
        </div>
    </div>
</div>

<script>
// Set today's date
document.getElementById('prescriptionDate').valueAsDate = new Date();

function calculateAge(dob) {
    if(!dob) return '--';
    const birthDate = new Date(dob);
    const today = new Date();
    let age = today.getFullYear() - birthDate.getFullYear();
    const m = today.getMonth() - birthDate.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) age--;
    return age;
}

function updatePreview() {
    document.getElementById('docNamePreview').innerText = document.getElementById('doctorName').value || 'Dr. Name, Credentials';
    document.getElementById('clinicPreview').innerText = document.getElementById('clinicName').value || 'Clinic / Hospital';

    const patientName = document.getElementById('patientName').value || '--';
    const dob = document.getElementById('dob').value;
    const age = calculateAge(dob);
    const gender = document.getElementById('patientGender').value || '--';
    document.getElementById('patientPreview').innerText = patientName;
    document.getElementById('dobAgeGenderPreview').innerText = `${dob || '--'} / ${age} yr / ${gender}`;
    
    const date = document.getElementById('prescriptionDate').value || '--';
    document.getElementById('datePreview').innerText = date;

    document.getElementById('complaintsPreview').innerText = document.getElementById('complaints').value || '--';
    document.getElementById('examinationPreview').innerText = document.getElementById('examination').value || '--';
    document.getElementById('investigationsPreview').innerText = document.getElementById('investigations').value || '--';
    document.getElementById('diagnosisPreview').innerText = document.getElementById('diagnosis').value || '--';

    const drugsPreview = document.getElementById('drugsPreview');
    drugsPreview.innerHTML = '';
    document.querySelectorAll('#drugTable tbody tr').forEach(row => {
        const cells = row.querySelectorAll('input');
        if(cells[0].value.trim() !== ''){
            const li = document.createElement('li');
            li.innerText = `${cells[0].value} - ${cells[1].value || '-'} - ${cells[2].value || '-'} - ${cells[3].value || '-'}`;
            drugsPreview.appendChild(li);
        }
    });
}

function addDrugRow() {
    const tbody = document.querySelector('#drugTable tbody');
    const tr = document.createElement('tr');
    tr.innerHTML = `
        <td><input type="text" placeholder="Drug Name" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Dose" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Times/Day" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Duration" oninput="updatePreview()"></td>
    `;
    tbody.appendChild(tr);
}

function clearForm() {
    document.querySelectorAll('input, textarea, select').forEach(el => el.value = '');
    document.querySelector('#drugTable tbody').innerHTML = '';
    document.getElementById('prescriptionDate').valueAsDate = new Date();
    updatePreview();
}

function printPrescription() { window.print(); }

updatePreview();
</script>

</body>
</html>
