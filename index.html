<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prescription App with Drug Type</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f2f2f2; }
.container { max-width:1200px; margin:0 auto; padding:20px; }
input, select, textarea { padding:8px; border-radius:5px; border:1px solid #ccc; margin-top:5px; width:100%; box-sizing:border-box; }
textarea { resize: vertical; }
button { padding:10px 15px; margin:5px; border:none; background:#004080; color:#fff; border-radius:5px; cursor:pointer; }
button:hover { background:#003366; }

.patient-row { display:flex; gap:10px; margin-top:10px; }
.patient-row > div { flex:1; }

.drug-table { width:100%; border-collapse:collapse; margin-top:10px; }
.drug-table th, .drug-table td { padding:5px; text-align:left; }

.prescription { width:100%; min-height:29.7cm; padding:40px 60px; background:#fff; box-sizing:border-box; color:#000; line-height:1.5; margin-top:30px; }
.header { text-align:center; margin-bottom:20px; }
.header h3, .header h4 { margin:2px 0; }
.patient-info { margin-bottom:20px; }
.patient-info div.row { display:flex; justify-content:space-between; width:100%; }
.content { display:flex; gap:20px; border-top:2px solid #000; padding-top:20px; min-height:400px; }
.left { width:33%; padding-right:10px; border-right:2px solid #000; }
.right { width:67%; padding-left:10px; }
.signature { text-align:right; margin-top:80px; font-weight:bold; }

@media (max-width:768px){ 
    .patient-row { flex-direction: column; } 
    .content { flex-direction: column; } 
    .left,.right{width:100%; border-right:none; padding:0;} 
}

@media print{
    body *{visibility:hidden;}
    .prescription, .prescription *{visibility:visible;}
    .prescription{width:100%; height:29.7cm; padding:40px 60px; box-shadow:none;}
    .drug-table, .drug-table th, .drug-table td{border:none; padding:0;}
    .no-print{display:none;}
}
</style>
</head>
<body>

<div class="container">
    <h2 class="no-print">Patient & Prescription Entry</h2>

    <!-- Patient Info -->
    <label>Patient Name</label>
    <input type="text" id="patientName" placeholder="Full Name">

    <div class="patient-row">
        <div>
            <label>Gender</label>
            <select id="patientGender">
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select>
        </div>
        <div>
            <label>Age</label>
            <input type="number" id="patientAge" placeholder="Age">
        </div>
        <div>
            <label>Weight (kg)</label>
            <input type="number" id="patientWeight" placeholder="Weight">
        </div>
    </div>

    <label class="no-print">Date of Birth (optional for auto age)</label>
    <input type="date" id="dob" class="no-print" onchange="calculateDOBAge()">

    <label>Date of Prescription</label>
    <input type="date" id="prescriptionDate">

    <!-- Doctor Info -->
    <label>Doctor Name & Credentials</label>
    <input type="text" id="doctorName" placeholder="Dr. A B C, MBBS, FCPS">
    <label>Clinic / Hospital</label>
    <input type="text" id="clinicName" placeholder="City Clinic">

    <!-- Prescription Details -->
    <label>Chief Complaints</label>
    <textarea id="complaints" rows="2"></textarea>
    <label>On Examination</label>
    <textarea id="examination" rows="2"></textarea>
    <label>Investigations</label>
    <textarea id="investigations" rows="2"></textarea>
    <label>Diagnosis</label>
    <textarea id="diagnosis" rows="2"></textarea>

    <!-- Drugs -->
    <label>Drugs</label>
    <table class="drug-table" id="drugTable">
        <thead>
            <tr>
                <th>Type</th>
                <th>Drug Name</th>
                <th>Dose</th>
                <th>Times/Day</th>
                <th>Duration</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button type="button" onclick="addDrugRow()">+ Add Drug</button>
    <button type="button" onclick="updatePreview()">Update Preview</button>
    <button type="button" onclick="printPrescription()">Print Prescription</button>

    <!-- Prescription Preview -->
    <div class="prescription" id="prescriptionPreview">
        <div class="header">
            <h3 id="docNamePreview">Dr. Name, Credentials</h3>
            <h4 id="clinicPreview">Clinic / Hospital</h4>
        </div>
        <div class="patient-info">
            <strong>Date:</strong> <span id="datePreview">--</span><br>
            <strong>Patient:</strong> <span id="patientPreview">Name</span><br>
            <div class="row">
                <span><strong>Gender:</strong> <span id="genderPreview">--</span></span>
                <span><strong>Age:</strong> <span id="agePreview">--</span></span>
                <span><strong>Weight:</strong> <span id="weightPreview">--</span></span>
            </div>
        </div>
        <div class="content">
            <div class="left">
                <div><strong>Chief Complaints:</strong> <span id="complaintsPreview">--</span></div>
                <div><strong>On Examination:</strong> <span id="examinationPreview">--</span></div>
                <div><strong>Investigations:</strong> <span id="investigationsPreview">--</span></div>
            </div>
            <div class="right">
                <div><strong>Prescription / Medicines:</strong>
                    <ul id="drugsPreview"></ul>
                </div>
            </div>
        </div>
        <div class="signature">Doctor Signature</div>
    </div>

</div>

<script>
document.getElementById('prescriptionDate').valueAsDate=new Date();

// Auto-calculate age from DOB
function calculateDOBAge(){
    const dob=document.getElementById('dob').value;
    if(!dob) return;
    const birth=new Date(dob);
    const today=new Date();
    let age=today.getFullYear()-birth.getFullYear();
    const m=today.getMonth()-birth.getMonth();
    if(m<0||(m===0&&today.getDate()<birth.getDate())) age--;
    document.getElementById('patientAge').value=age;
}

// Add Drug Row
function addDrugRow(){
    const tbody=document.querySelector('#drugTable tbody');
    const tr=document.createElement('tr');
    tr.innerHTML=`
        <td>
            <select oninput="updatePreview()">
                <option value="">Select</option>
                <option value="Tab">Tab</option>
                <option value="Syp">Syp</option>
                <option value="Cap">Cap</option>
                <option value="Sup">Sup</option>
                <option value="IV">IV</option>
                <option value="Inf">Inf</option>
            </select>
        </td>
        <td><input type="text" placeholder="Drug Name" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Dose" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Times/Day" oninput="updatePreview()"></td>
        <td><input type="text" placeholder="Duration" oninput="updatePreview()"></td>
    `;
    tbody.appendChild(tr);
}

// Update Preview
function updatePreview(){
    document.getElementById('docNamePreview').innerText=document.getElementById('doctorName').value||'Dr. Name, Credentials';
    document.getElementById('clinicPreview').innerText=document.getElementById('clinicName').value||'Clinic / Hospital';

    const name=document.getElementById('patientName').value||'--';
    const age=document.getElementById('patientAge').value||'--';
    const gender=document.getElementById('patientGender').value||'--';
    const weight=document.getElementById('patientWeight').value||'--';
    document.getElementById('patientPreview').innerText=name;
    document.getElementById('agePreview').innerText=age + ' yr';
    document.getElementById('genderPreview').innerText=gender;
    document.getElementById('weightPreview').innerText=weight + ' kg';

    document.getElementById('datePreview').innerText=document.getElementById('prescriptionDate').value||'--';
    document.getElementById('complaintsPreview').innerText=document.getElementById('complaints').value||'--';
    document.getElementById('examinationPreview').innerText=document.getElementById('examination').value||'--';
    document.getElementById('investigationsPreview').innerText=document.getElementById('investigations').value||'--';
    document.getElementById('diagnosisPreview').innerText=document.getElementById('diagnosis').value||'--';

    const drugsPreview=document.getElementById('drugsPreview');
    drugsPreview.innerHTML='';
    document.querySelectorAll('#drugTable tbody tr').forEach(row=>{
        const cells=row.querySelectorAll('input, select');
        if(cells[1].value.trim()!==''){ // Drug Name must not be empty
            const type = cells[0].value ? cells[0].value + ' ' : '';
            const li=document.createElement('li');
            li.innerText=`${type}${cells[1].value} - ${cells[2].value||'-'} - ${cells[3].value||'-'} - ${cells[4].value||'-'}`;
            drugsPreview.appendChild(li);
        }
    });
}

function printPrescription(){ window.print(); }
</script>

</body>
</html>
